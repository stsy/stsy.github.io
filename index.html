<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Kana Campfire</title>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;700&display=swap" rel="stylesheet">

  <style>
    body {
      margin: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
      background: linear-gradient(180deg, #1e1e2e, #2b2b45);
      color: #f5f5f7;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
    }

    .app { max-width: 420px; padding: 24px; width: 100%; }

    .title { text-align: center; font-size: 28px; margin-bottom: 6px; }
    .subtitle { text-align: center; font-size: 14px; opacity: 0.7; margin-bottom: 12px; }

    .mode-toggle { display: flex; justify-content: center; gap: 8px; margin-bottom: 18px; }
    .mode-toggle button {
      background: #1f2038; color: #f5f5f7; border: none;
      padding: 6px 12px; border-radius: 999px; font-size: 13px; opacity: 0.6;
    }
    .mode-toggle button.active { opacity: 1; background: #35365f; }

    .card {
      background: #2f3050; border-radius: 20px; padding: 40px 20px;
      text-align: center; position: relative; overflow: hidden;
      box-shadow: 0 20px 40px rgba(0,0,0,0.3);
    }

    .hiragana {
      font-family: "Noto Sans JP", system-ui, sans-serif;
      font-size: 96px; margin-bottom: 20px; position: relative; z-index: 2;
    }

    .flame-bg {
      position: absolute; top: 42%; left: 50%;
      transform: translate(-50%, -50%); font-size: 140px;
      opacity: 0.18; pointer-events: none; z-index: 1;
      animation: flameIdle 2.8s ease-in-out infinite;
    }

    @keyframes flameIdle {
      0% { transform: translate(-50%, -50%) scale(1); opacity: 0.16; }
      50% { transform: translate(-50%, -50%) scale(1.05); opacity: 0.22; }
      100% { transform: translate(-50%, -50%) scale(1); opacity: 0.16; }
    }

    @keyframes flamePulse {
      0% { transform: translate(-50%, -50%) scale(1); }
      40% { transform: translate(-50%, -50%) scale(1.25); }
      100% { transform: translate(-50%, -50%) scale(1); }
    }

    .flame-pulse { animation: flamePulse 0.35s ease-out; }

    input {
      width: 4ch; padding: 10px 12px; border-radius: 10px; border: none;
      font-size: 20px; text-align: center; background: #1f2038; color: #fff;
      margin: 0 auto; display: block; outline: none;
    }

    .streak { margin-top: 18px; font-size: 17px; font-weight: 600; }

    .hint {
      position: absolute; inset: 0; display: flex; align-items: center; justify-content: center;
      font-family: "Noto Sans JP", system-ui, sans-serif;
      font-size: 48px; opacity: 0; pointer-events: none;
      z-index: 0;
    }

    .hint.red { color: rgba(255, 80, 80, 0.55); }
    .hint.green { color: rgba(120, 255, 160, 0.45); }

    @keyframes hintFade {
      0% { opacity: 0; transform: translateY(6px); }
      20% { opacity: 0.35; transform: translateY(0); }
      80% { opacity: 0.35; }
      100% { opacity: 0; transform: translateY(-4px); }
    }

    footer { margin-top: 24px; text-align: center; opacity: 0.6; font-size: 12px; }
  </style>
</head>
<body>
  <div class="app">
    

    <div class="mode-toggle">
      <button id="hiraganaBtn" class="active">Hiragana</button>
      <button id="katakanaBtn">Katakana</button>
    </div>

    <div class="card">
      <div class="flame-bg" id="flameBg">üî•</div>
      <div class="hiragana" id="kana">„ÅÇ</div>
      <div class="hint" id="hint"></div>

      <input id="answer" autocomplete="off" autocorrect="off" autocapitalize="none" spellcheck="false" inputmode="latin" maxlength="3" />

      <div class="streak">Streak: <span id="streak">0</span> ¬∑ Best: <span id="best">0</span></div>
    </div>

    <footer id="footer">¬∑ Kana Campfire ¬∑ Hiragana Practice</footer>
  </div>

  <script>
    const hiraganaCards = [
      { k:'„ÅÇ', r:'a' },{ k:'„ÅÑ', r:'i' },{ k:'„ÅÜ', r:'u' },{ k:'„Åà', r:'e' },{ k:'„Åä', r:'o' },
      { k:'„Åã', r:'ka' },{ k:'„Åç', r:'ki' },{ k:'„Åè', r:'ku' },{ k:'„Åë', r:'ke' },{ k:'„Åì', r:'ko' },
      { k:'„Åå', r:'ga' },{ k:'„Åé', r:'gi' },{ k:'„Åê', r:'gu' },{ k:'„Åí', r:'ge' },{ k:'„Åî', r:'go' },
      { k:'„Åï', r:'sa' },{ k:'„Åó', r:'shi' },{ k:'„Åô', r:'su' },{ k:'„Åõ', r:'se' },{ k:'„Åù', r:'so' },
      { k:'„Åñ', r:'za' },{ k:'„Åò', r:'ji' },{ k:'„Åö', r:'zu' },{ k:'„Åú', r:'ze' },{ k:'„Åû', r:'zo' },
      { k:'„Åü', r:'ta' },{ k:'„Å°', r:'chi' },{ k:'„Å§', r:'tsu' },{ k:'„Å¶', r:'te' },{ k:'„Å®', r:'to' },
      { k:'„Å†', r:'da' },{ k:'„Å¢', r:'ji' },{ k:'„Å•', r:'zu' },{ k:'„Åß', r:'de' },{ k:'„Å©', r:'do' },
      { k:'„Å™', r:'na' },{ k:'„Å´', r:'ni' },{ k:'„Å¨', r:'nu' },{ k:'„Å≠', r:'ne' },{ k:'„ÅÆ', r:'no' },
      { k:'„ÅØ', r:'ha' },{ k:'„Å≤', r:'hi' },{ k:'„Åµ', r:'fu' },{ k:'„Å∏', r:'he' },{ k:'„Åª', r:'ho' },
      { k:'„Å∞', r:'ba' },{ k:'„Å≥', r:'bi' },{ k:'„Å∂', r:'bu' },{ k:'„Åπ', r:'be' },{ k:'„Åº', r:'bo' },
      { k:'„Å±', r:'pa' },{ k:'„Å¥', r:'pi' },{ k:'„Å∑', r:'pu' },{ k:'„Å∫', r:'pe' },{ k:'„ÅΩ', r:'po' },
      { k:'„Åæ', r:'ma' },{ k:'„Åø', r:'mi' },{ k:'„ÇÄ', r:'mu' },{ k:'„ÇÅ', r:'me' },{ k:'„ÇÇ', r:'mo' },
      { k:'„ÇÑ', r:'ya' },{ k:'„ÇÜ', r:'yu' },{ k:'„Çà', r:'yo' },
      { k:'„Çâ', r:'ra' },{ k:'„Çä', r:'ri' },{ k:'„Çã', r:'ru' },{ k:'„Çå', r:'re' },{ k:'„Çç', r:'ro' },
      { k:'„Çè', r:'wa' },{ k:'„Çí', r:'wo' },{ k:'„Çì', r:'n' }
    ];

    const katakanaCards = hiraganaCards.map(c => ({
      k: String.fromCharCode(c.k.charCodeAt(0) + 0x60), r: c.r
    }));

    let deck = hiraganaCards;
    let current = null;
    let streak = 0;
    let best = Number(localStorage.getItem('bestStreak') || 0);

    const kanaEl = document.getElementById('kana');
    const input = document.getElementById('answer');
    const streakEl = document.getElementById('streak');
    const bestEl = document.getElementById('best');
    
    const flame = document.getElementById('flameBg');
    const hint = document.getElementById('hint');

    bestEl.textContent = best;

    function pickCard() {
      current = deck[Math.floor(Math.random() * deck.length)];
      kanaEl.textContent = current.k;
      input.value = '';
      input.focus();
    }

    function pulse() {
      flame.classList.remove('flame-pulse');
      void flame.offsetWidth;
      flame.classList.add('flame-pulse');
    }

    function showHint(text, color) {
      hint.textContent = text;
      hint.className = `hint ${color}`;
      hint.style.animation = 'none';
      void hint.offsetWidth;
      hint.style.animation = 'hintFade 1.2s ease-out';
    }

    input.addEventListener('keydown', e => {
      if (e.key !== 'Enter') return;
      const val = input.value.trim().toLowerCase();

      if (val === current.r) {
        streak++;
        pulse();
        showHint(current.r, 'green');
      } else {
        streak = 0;
        showHint(current.r, 'red');
      }

      if (streak > best) {
        best = streak;
        localStorage.setItem('bestStreak', best);
        bestEl.textContent = best;
      }
      streakEl.textContent = streak;
      pickCard();
    });

    document.getElementById('hiraganaBtn').onclick = () => {
      deck = hiraganaCards;
      document.getElementById('footer').textContent = '¬∑ Kana Campfire ¬∑ Hiragana Practice';
      document.getElementById('hiraganaBtn').classList.add('active');
      document.getElementById('katakanaBtn').classList.remove('active');
      streak = 0; streakEl.textContent = 0; pickCard();
    };

    document.getElementById('katakanaBtn').onclick = () => {
      deck = katakanaCards;
      document.getElementById('footer').textContent = '¬∑ Kana Campfire ¬∑ Katakana Practice';
      document.getElementById('katakanaBtn').classList.add('active');
      document.getElementById('hiraganaBtn').classList.remove('active');
      streak = 0; streakEl.textContent = 0; pickCard();
    };

    pickCard();
  </script>
</body>
</html>
